{% extends 'video/base.html' %}

{% load staticfiles %}

{% block head %}
<script src="{% static 'video/videojs/video.min.js' %}"></script>
<script src="{% static 'video/videojs/videojs-contrib-quality-levels.min.js' %}"></script>
<script src="{% static 'video/videojs/videojs-hls-quality-selector.min.js' %}"></script>
<link rel="stylesheet" type="text/css" href="{% static 'video/videojs/video-js.min.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'video/videojs/videojs-hls-quality-selector.css' %}">
<style>
    html, body {
        height: 100%;
    }

    .card {
        height: 100%;
    }

    video-js:fullscreen {
        padding: 0 !important;
    }
</style>
{% endblock %}

{% block page_title %}
    {{ video.title }}
{% endblock %}

{% block main %}
<div class="row my-4">
    <div class="col-md-12">
        <div align="center">
            <video-js id="video" class="vjs-fluid video-js vjs-default-skin vjs-big-play-centered" controls>
            </video-js>
        </div>
    </div>
</div>
<div class="row my-2">
    <div class="col-md-12 my-2">
        <div style="height: auto" class="card text-white bg-primary">
            <div class="card-header">{{ video.collection }}</div>
            <div class="card-body">
                <h4 class="card-title">{{ video.title }}</h4>
                <ul class="list-group list-group-flush">
                    {# <li class="list-group-item bg-dark">Length: 22:49</li> #}
                    {# <li class="list-group-item bg-dark">Episode No: 1</li> #}
                    <li class="list-group-item bg-dark">
                        {{ video.description }}
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% if next_videos %}
    <div class="row my-2 bg-dark">
        <div class="text-center col-12 p-2">
            <h3 class="text-white bg-primary p-2 mb-0">
                Up next
            </h3>
        </div>
        <div class="col-12">
            <div class="row my-2">
                {% for next_video in next_videos %}
                    <div class="col-md-4 mb-2">
                        <div class="row text-center mx-0 mb-2">
                            <a class="btn btn-secondary w-100" href="{% url 'video_index' collection=next_video.collection.slug %}">
                                {{ next_video.collection.title }}
                            </a>
                        </div>
                        <a href="{% url 'video_player' slug=next_video.video.slug %}">
                            <img class="img-fluid" src="{% url 'get_thumbnail' slug=next_video.video.slug %}">
                        </a>
                        <div class="text-white mb-1">
                            <a href="{% url 'video_player' slug=next_video.video.slug %}">
                                <div class="row text-white bg-primary h-75 mx-0">
                                    <div class="card-body mw-100 pt-2 pb-0">
                                        <h4 class="card-title"><bold>{{ next_video.video.title }}</bold> - {{ next_video.video.play_time }}</h4>
                                        <p class="text-truncate">{{ next_video.video.description }}</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
{% endif %}
<script>
$(window).ready(function(){
var options = {
    html5: {
        hls: {
            overrideNative: true,
        },
        nativeAudioTracks: false,
        nativeVideoTracks: false,
    }
};

    player = videojs('video', options);
    {% if video %}
        player.src({
            src: "{% url 'get_master_playlist' slug=video.slug %}",
            type: "application/x-mpegURL"
        });

        player.hlsQualitySelector();

        player.play();
    {% endif %}
	});
</script>
{% endblock %}
